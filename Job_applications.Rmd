---
title: "Job_applications"
authors: "Sajan Kumar Kar, Sai Pavan Mekala, Neelima Puthanveetil, Sandhya Karki"
date: "2023-10-15"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Import Libraries
Team Global project on Job Applications Data

```{r Libraries}
# uncomment and run the below line to install the required packages
#install.packages(c("gganimate", "png", "gifski"))
library(ggplot2)
library(tidyr)
library(dplyr)
library(ezids)
library(gganimate)
library(png)
library(gifski)
library(gridExtra)
```

## 2. Import Data

```{r Import_data}
df = data.frame(read.csv('stackoverflow_full.csv', header = TRUE))
xkabledplyhead(df)
```
```{r Structure}
#structure of a data frame 
str(df) 
```

The dataframe has 73462 records. We have index, employemnt, yearscode, yearscodepro and previoussalary as integer type and the rest are of character types. Going ahead we would need to convert some of them to factors.

## 3. Data preprocessing & Cleaning

Let's first check for missing values and duplicate values if any.

```{r missing values}
# Check the missing values and count them in each column
print(colSums(is.na(df)))
```

```{r missing values plot}

box_color <- "black"
bg_color <- "lightblue"

# Checking for missing values
missing_data <- data.frame(
  Variable = names(df),
  Missing_Values = sapply(df, function(x) sum(is.na(x)))
)

# Creating a bar plot to visualize missing values 
plot <- ggplot(missing_data, aes(x = Variable, y = Missing_Values)) +
  geom_bar(stat = "identity", fill = bar_color) +
  labs(title = "Missing Values in the Dataset",
       x = "Variables",
       y = "Number of Missing Values") +
  theme_minimal() +  # Change the background to gray
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.background = element_rect(fill = bg_color))

plot <- plot + geom_boxplot(aes(y = Missing_Values), fill = box_color)

plot <- plot + scale_y_continuous(breaks = seq(0, max(missing_data$Missing_Values), by = 1))

# plot
print(plot)
```


```{r duplicates}
# Check duplicates
length(unique(df$Index))
```

We notice that there are no missing values and duplicates in the data. So, we have all the observations to work with.

Now that we know this, let us do some cleaning and feature engineering. First we'll extract the numeric columns.

```{r Numeric columns}
# Extract the numeric columns
head(subset(df, select = c(names(df)[sapply(df, is.numeric)])))
```

* The index column will not be required, so we will drop it (We can use the in-built index of a dataframe).
* We will convert employment into factor and change the values for a better sense.
* We will do the same for employed

```{r numeric feature cleaning}
df_clean <- subset(df, select = -c(Index))
df_clean$Employment = as.character(df_clean$Employment)
df_clean$Employment[df_clean$Employment == "1"] <- "currently_employed"
df_clean$Employment[df_clean$Employment=="0"] <- "not_currently_employed"
df_clean$Employment = factor(df_clean$Employment)
df_clean$Employed = as.character(df_clean$Employed)
df_clean$Employed[df_clean$Employed == "1"] <- "hired"
df_clean$Employed[df_clean$Employed == "0"] <- "not_hired"
df_clean$Employed = factor(df_clean$Employed)
str(df_clean)
```

Now let's take a look at the character columns.

```{r char columns}
# Extract the character columns
head(subset(df_clean, select = c(names(df)[sapply(df, is.character)])))

```

* Except Country and Haveworkedwith, the rest are clearly categorical features, so we will convert them to factor data type
* Edlevel is an ordinal feature 


```{r char feature cleaning}
df_clean$Age = factor(df_clean$Age)
df_clean$Accessibility = factor(df_clean$Accessibility)
df_clean$EdLevel = factor(df_clean$EdLevel, ordered = T, 
                          levels = c("Other", "NoHigherEd", "Undergraduate", "Master", "PhD"))
df_clean$Gender = factor(df_clean$Gender)
df_clean$MentalHealth = factor(df_clean$MentalHealth)
df_clean$MainBranch = factor(df_clean$MainBranch)
str(df_clean)
```

*"Other" for now is set to be the lowest level. Ideally it should be excluded from the ranking of the levels. But there are about 10000 observations with "other", hence we cannot drop so many rows*

Let's check the number of different countries we have.

```{r country}
length(unique(df_clean$Country))

```

There are 172 different countries. (Leaving this as it is for the time being)

Let's see if there is data where their professional coding experience is more than their coding experience. If there is such data, we have to remove it because that's practically faulty data.

```{r remove faulty data}

nrow(subset(df_clean, subset = df_clean$YearsCode<df_clean$YearsCodePro))
# We observe 588 such records
df_clean = subset(df_clean, subset = df_clean$YearsCode>df_clean$YearsCodePro)

```



```{r Basic Statistics}

# Getting the number of rows and columns
num_rows <- dim(df)[1]
num_columns <- dim(df)[2]

# Getting the number of discrete and continuous columns
discrete_columns <- sum(sapply(df, is.factor))
continuous_columns <- sum(sapply(df, is.numeric))

# Checking for missing values
missing_columns <- sum(colSums(is.na(df)) > 0)
missing_observations <- sum(rowSums(is.na(df)) > 0)

# Getting the number of complete rows
complete_rows <- sum(complete.cases(df))

# Calculating the total number of observations
total_observations <- num_rows * num_columns

# Memory allocation
memory_allocation <- format(object.size(df), units = "Mb")

# Displaying the information
cat("Basic Statistics and Raw Counts for the Dataset:\n")
cat("Rows:", num_rows, "\n")
cat("Columns:", num_columns, "\n")
cat("Discrete columns:", discrete_columns, "\n")
cat("Continuous columns:", continuous_columns, "\n")
cat("All missing columns:", missing_columns, "\n")
cat("Missing observations:", missing_observations, "\n")
cat("Complete Rows:", complete_rows, "\n")
cat("Total observations:", total_observations, "\n")
cat("Memory allocation:", format(memory_allocation, units = "auto"), "\n")

```


```{r Basic Statistics Plots}


# Creating a data frame for plotting
data <- data.frame(statistic = stat_labels, count = statistics)

# Making "statistic" a factor variable
data$statistic <- factor(data$statistic, levels = stat_labels)

# defining the colors
stat_colors <- c(
  "Rows" = "skyblue",
  "All missing columns" = "green",
  "Missing observations" = "blue",
  "Complete Rows" = "red",
  "Total observations" = "yellow"
)

# Remove the rows 
data <- data[!(data$statistic %in% c("Columns", "Discrete columns", "Continuous columns")), ]

# Creating a bar plot 
p <- ggplot(data, aes(x = count, y = statistic, fill = statistic, label = "")) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(title = "Basic Statistics and Raw Counts",
       x = "Count", y = "Statistic") +
  theme_minimal() +
  scale_fill_manual(values = stat_colors) +
  guides(fill = guide_legend(override.aes = list(color = "black"), title = "Count"))


p <- p + geom_point(data = data[data$count == 0, ], aes(x = 0, y = statistic), color = "black", size = 3)

# Creating the table for percentages
table_df <- data.frame(statistic = data$statistic, percentage = paste0(round((data$count / sum(data$count)) * 100, 2), "%"))
table <- tableGrob(table_df, rows = NULL)

# Arranging the plot
grid.arrange(p, table, ncol = 1, heights = c(4, 1))


```


Let's take a look at some plots and distribution in order to deal with outliers.

```{r outlier detection}
# Create a list of the columns that we use in combined boxplot
columns_to_plot <- c("YearsCode", "YearsCodePro", "PreviousSalary", "ComputerSkills")

# Set up the plotting area to display all boxplots together
par(mfrow = c(2, length(columns_to_plot)))

# Display the boxplots
for (i in 1:length(columns_to_plot)) {
  boxplot(df_clean[[columns_to_plot[i]]], main = columns_to_plot[i],col = "lightblue")
}
for (i in 1:length(columns_to_plot)) {
  hist(df_clean[[columns_to_plot[i]]], main = columns_to_plot[i], xlab = element_blank(), col = "lightblue")
}
# plotting area layout
par(mfrow = c(2, 1))

```

So we notice that, all these are right skewed distributions with quite a bit of outliers. All the outliers are on the higher end. Let's check the crictical value for these outliers.

```{r quantiles}
o_code= quantile(df_clean$YearsCode, probs = 0.75, na.rm = FALSE) + 
  (1.5 * IQR(df_clean$YearsCode))
o_procode = quantile(df_clean$YearsCodePro, probs = 0.75, na.rm = FALSE) + 
  (1.5 * IQR(df_clean$YearsCodePro))
o_presal = quantile(df_clean$PreviousSalary, probs = 0.75, na.rm = FALSE) + 
  (1.5 * IQR(df_clean$PreviousSalary))
o_cskill = quantile(df_clean$ComputerSkills, probs = 0.75, na.rm = FALSE) + 
  (1.5 * IQR(df_clean$ComputerSkills))

print(paste(o_code, o_procode, o_presal, o_cskill))
```

So, as per the IQR method, for it to be an outlier we get:

* 39.5 years of coding experience
* 25.5 years of professional coding experience
* 193596 as the previous salary
* 30.5 as the number of computer skills

Someone can have 25.5+ years of professional coding experience. So, it doesn't make sense to remove everything above this value. A good approximation would be 40 years. So we'll consider anyone who has above 40 years of coding and professional coding experience as an outlier and thus remove such observations.

31 computer skills is quite a lot for some, not so much for others. So let's go with a higher approximation of 35 to remove outliers for this.

193k seems a good critical value for an outlier, but since we do not know the currency of salary, let's not remove the higher salary values. There could be people who had an extremely high salary. This scenario isn't unlikely in our world.

```{r outlier removal}
df_clean = subset(df_clean, subset = df_clean$YearsCode < 40)
df_clean = subset(df_clean, subset = df_clean$YearsCodePro < 40)
df_clean = subset(df_clean, subset = df_clean$ComputerSkills < 35)
```


Lets take a look at the data now:

```{r final data}
df_final <- df_clean
head(df_final)

print(paste("Number of records in final data:", nrow(df_final)))

```


## 4. EDA


```{r}
library(DataExplorer)
#DataExplorer::create_report(df)
```


```{r }


#names of numeric columns
numeric_cols <- sapply(df, is.numeric)
numeric_cols <- names(df)[numeric_cols]

# Creating a directory to save the plots
output_dir <- "numerical_histograms"
dir.create(output_dir, showWarnings = FALSE)


custom_colors <- c("skyblue", "pink", "orange", "purple", "green")

# Looping through the numerical columns and create histograms
for (col in numeric_cols) {
  color_index <- match(col, numeric_cols) %% length(custom_colors) + 1
  fill_color <- custom_colors[color_index]

  # Creating a histogram
  hist_plot <- ggplot(df, aes(x = .data[[col]]) ) +
    geom_histogram(fill = fill_color, color = "darkblue", bins = 20) +
    labs(title = paste("Histogram of", col),
         x = col,
         y = "Frequency") +
    theme_minimal()

  
  hist_output_file <- file.path(output_dir, paste0("histogram_", col, ".png"))
  ggsave(filename = hist_output_file, plot = hist_plot, width = 6, height = 4)

  print(hist_plot)
}


```


```{r}
# Creating a map of responses by country
ggplot(data = df_final, aes(map_id = Country)) +
  geom_map(aes(fill = Age), map = world_map) +
  expand_limits(x = world_map$long, y = world_map$lat)

```

```{r}
ggplot(data = df_final, aes(map_id = Country)) +
  geom_map(aes(fill = MentalHealth), map = world_map) +
  expand_limits(x = world_map$long, y = world_map$lat)
```

```{r}
ggplot(data = df_final, aes(map_id = Country)) +
  geom_map(aes(fill = EdLevel), map = world_map) +
  expand_limits(x = world_map$long, y = world_map$lat)
```

```{r}
ggplot(data = df_final, aes(map_id = Country)) +
  geom_map(aes(fill = Employment), map = world_map) +
  expand_limits(x = world_map$long, y = world_map$lat)
```



```{r plot- Ed by Gender}

ggplot(data = subset(df_final, subset = Employed=='hired'), aes(EdLevel, after_stat(count))) + 
  geom_bar(aes(fill = Gender), position = 'dodge', alpha = 0.5) +
  labs(title = "Education Level by gender for employed workers", x="Education Level", y="Count")

```

```{r plot- Ed by Emp}
ggplot(data = df_final, aes(EdLevel)) + 
  geom_bar(aes(fill = Employment), position = 'dodge', alpha = 0.5) +
  labs(title = "Education Level by Employment", x="Education Level", y="Count")

```

```{r plot- MainBranch by Age}
ggplot(data = df_final, aes(MainBranch)) + 
  geom_bar(aes(fill = Age), position = 'dodge', alpha = 0.5) +
  labs(title = "MainBranch by Age", x="MainBranch", y="Count")

```

```{r plot- PrevSal by MentalHealth(1)}
ggplot(data = df_final, aes(x = PreviousSalary, fill = MentalHealth)) +
  geom_density(alpha = 0.5) +
  labs(title = "Density plot of Previous Salary by Mental Health", x="Previous Salary", y= 'Density')

```

```{r plot- PrevSal by MentalHealth(2)}

ggplot(data = df_final, aes(x = MentalHealth, y = PreviousSalary)) +
  geom_jitter(alpha = 0.5, col = 'navy') +
  labs(title = "Previous Salary by Mental Health", x = 'Mental Health', y="Previous Salary")

```

```{r plot- PrevSal by MentalHealth(3)}
plotdata <- df_final %>%
  group_by(MentalHealth) %>%
  summarize(mean_prevsalary = mean(PreviousSalary))

ggplot(data = plotdata, aes(x = MentalHealth, y = mean_prevsalary)) +
  geom_bar(stat = 'identity', alpha = 0.5, aes(fill = MentalHealth)) +
  labs(title = "Mean Previous Salary by Mental Health", x = 'Mental Health', y="Previous Salary")

```


```{r skills extraction}

df_final %>%
separate_rows(HaveWorkedWith, sep = ";") %>% 
group_by(HaveWorkedWith) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) -> skills_df
head(skills_df, 10)
```

We see that Javascript, Docker and HTML/CSS are the skills known by majority of the applicants.

```{r plot- Top 10 skills known}

plot <- ggplot(data = head(skills_df, 10), aes(x = reorder(HaveWorkedWith, Count), y = Count)) + 
  geom_bar(stat = 'identity', aes(fill = HaveWorkedWith), alpha = 0.6) + 
  coord_flip() + 
  theme(axis.text.x = element_blank(),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_line(size = 0.1, color = "grey"),
        panel.grid.minor.x = element_line(size = 0.1, color = "grey"),
        plot.background = element_blank()) + 
  geom_text(aes(y = Count, label = Count)) +
  labs(title = "Skills used by number of applicants", 
       x = "Skill", y = "No. of applicants possessing the skill")

anim <- plot + 
    transition_states(HaveWorkedWith, transition_length = 4, wrap = FALSE) + 
  shadow_mark() + 
  enter_grow() +
  enter_fade() + 
  ease_aes('sine-in')
  
animate(anim)
#anim_save("Skills.gif", anim)
```

Now Lets see the skills that make the most money

```{r plot- Highest earning skills}

df_final %>%
separate_rows(HaveWorkedWith, sep = ";") %>% 
group_by(HaveWorkedWith) -> skills_df2

aggregate(skills_df2$PreviousSalary, by = list(skills_df2$HaveWorkedWith), FUN = sum) %>%
arrange(desc(x)) -> skills_df2
colnames(skills_df2) <- c('Skills', 'TotalEarning')


plot <- ggplot(data = head(skills_df2, 10), aes(x = reorder(Skills, TotalEarning), y = TotalEarning)) + 
  geom_bar(stat = 'identity', aes(fill = Skills), alpha = 0.6) + 
  coord_flip() + 
  theme(axis.text.x = element_blank(),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_line(size = 0.1, color = "grey"),
        panel.grid.minor.x = element_line(size = 0.1, color = "grey"),
        plot.background = element_blank()) + 
  geom_text(aes(y = TotalEarning, label = paste(round(TotalEarning/1000000, 2), 'M'))) +
  labs(title = "Top 10 earning skills", 
       x = "Skill", y = "Total earnings")

anim <- plot + 
    transition_states(Skills, transition_length = 4, wrap = FALSE) + 
  shadow_mark() + 
  enter_grow() +
  enter_fade() + 
  ease_aes('sine-in')
  
animate(anim)
#anim_save("SkillsEarnings.gif", anim)
```


Because we have over 65,000 data points, we can use statistical methods that apply to data satisfying normality conditions (because of the central limit theorem).

MAKE SURE TO INCLUDE TEST ASSUMPTIONS

## Hypothesis Testing ##

### Test 1: Is there a significant difference between employed males and non-males in their respective education levels?

MAKE SURE TO INCLUDE TEST ASSUMPTIONS

We first want to check whether there is a difference in the number of males vs non-males employed at every level of education.

Because we have over 73,000 data points, we may use statistical methods that apply to data satisfying normality conditions (because of the central limit theorem).

Hence, we use a series of two sample z tests to conduct our first set hypothesis tests.

The assumptions we need to satisfy are:
_
_
_
_

We first want to look at the individuals with a bachelor's degree.
$H_0:$ There is no difference in the number of undergraduate males who are employed when compared to nonmales
$H_a:$ There is a significant difference in the number of undergraduate males who are employed when compared to nonmales
```{r, two sample z test for proportions: undergraduate}
# We first subset into the different education levels, here undergraduate
undergrad <- subset(df_final, df_final$EdLevel == "Undergraduate")


# For the two sample z test, we need our two samples, males and nonmales
undergrad_male <- subset(undergrad, undergrad$Gender == "Man") # Sample 1, males

undergrad_male_employed <- subset(undergrad_male, undergrad_male$Employment == "currently_employed")

undergrad_nonmales <- subset(undergrad, undergrad$Gender != "Man") # Sample 2, females and nonbinary

undergrad_nonmales_employed <- (subset(undergrad_nonmales, undergrad_nonmales$Employment == "currently_employed"))


undergrad_employed_ztest <- prop.test(c(31509, 2319), c(34855,2547))
undergrad_employed_ztest

cat("The proportion of undergraduate males who are employed is:", nrow(undergrad_male_employed)/nrow(undergrad_male), "\n")
cat("The proportion of undergraduate nonmales who are employed is:", nrow(undergrad_nonmales_employed)/nrow(undergrad_nonmales), "\n")
cat("Our two sample z test statistic is:", undergrad_employed_ztest$statistic, "which has an associated p-value of", undergrad_employed_ztest$p.value, ".\n")
cat("At and alpha-level of .05 we fail to reject the null hypothesis and conclude that there is not a significant difference in the number of males vs nonmales who have a bachelor's degree and are employed.")
```

The proportion of undergraduate males who are employed is: 
The proportion of undergraduate nonmales who are employed is:
Our two sample z test statistic is: _ which has an associated p-value of _.
At and alpha-level of .05 we fail to reject the null hypothesis and conclude that there is not a significant difference in the number of males vs nonmales who have a bachelor's degree and are employed.

We now look at individuals with a masters.
$H_0:$ There is no difference in the number of males with a master's degree who are employed when compared to nonmales
$H_a:$ There is a significant difference in the number of males with a master's degree who are employed when compared to nonmales

```{r, two sample z test for proportions: master's}
# We first subset into the different education levels, here masters
masters <- subset(df_final, df_final$EdLevel == "Master")


# For the two sample z test, we need our two samples, males and nonmales
masters_male <- subset(masters, masters$Gender == "Man") # Sample 1, males

masters_male_employed <- subset(masters_male, masters_male$Employment == "currently_employed")


masters_nonmales <- subset(masters, undergrad$Gender != "Man") # Sample 2, females and nonbinary

masters_nonmales_employed <- (subset(masters_nonmales, masters_nonmales$Employment == "currently_employed"))


masters_employed_ztest <- prop.test(c(15447, 1105), c(17579,2547))
masters_employed_ztest

cat("The proportion of males with a Masters who are employed is:", nrow(masters_male_employed)/nrow(masters_male), "\n")
cat("The proportion of nonmales with a Masters who are employed is:", nrow(masters_nonmales_employed)/nrow(masters_nonmales), "\n")
cat("Our two sample z test statistic is:", masters_employed_ztest$statistic, "which has an associated p-value of", masters_employed_ztest$p.value, ".\n")
cat("At and alpha-level of .05 we reject the null hypothesis and conclude that there is a significant difference in the number of males vs nonmales who have a master's degree and are employed.")
```

The proportion of males with a master's who are employed is: 
The proportion of nonmales with a master's who are employed is:
Our two sample z test statistic is: _ which has an associated p-value of _.
At and alpha-level of .05 we reject the null hypothesis and conclude that there is a significant difference in the number of males vs nonmales who have a master's degree and are employed.

Finally, we examine individuals who have a doctorate degree.
$H_0:$ There is no difference in the number of males with a PhD who are employed when compared to nonmales
$H_a:$ There is a significant difference in the number of males with a PhDwho are employed when compared to nonmales
```{r, two sample z test for proportions: Phd}
# We first subset into the different education levels, here PhD
phd <- subset(df_final, df_final$EdLevel == "PhD")


# For the two sample z test, we need our two samples, males and nonmales
phd_male <- subset(phd, phd$Gender == "Man") # Sample 1, males

phd_male_employed <- subset(phd_male, phd_male$Employment == "currently_employed")

phd_nonmales <- subset(phd, phd$Gender != "Man") # Sample 2, females and nonbinary

phd_nonmales_employed <- (subset(phd_nonmales, phd_nonmales$Employment == "currently_employed"))


phd_employed_ztest <- prop.test(c(2153, 185), c(2402,206))
phd_employed_ztest

# Printing the results using cat
cat("The proportion of males with a PhD who are employed is:", nrow(phd_male_employed)/nrow(phd_male), "\n")
cat("The proportion of nonmales with a PhD who are employed is:", nrow(phd_nonmales_employed)/nrow(phd_nonmales), "\n")
cat("Our two sample z test statistic is:", phd_employed_ztest$statistic, "which has an associated p-value of", phd_employed_ztest$p.value, ".\n")
cat("At an alpha-level of .05 we fail to reject the null hypothesis and conclude that there is not a significant difference in the number of males vs nonmales who have a doctorate degree and are employed.")
```

The proportion of males with a PhD who are employed is: 
The proportion of nonmales with a PhD who are employed is:
Our two sample z test statistic is: _ which has an associated p-value of _.
At and alpha-level of .05 we fail to reject the null hypothesis and conclude that there is not a significant difference in the number of males vs nonmales who have a doctorate degree and are employed.

[real world conclusion]

In real-world scenarios, these results might suggest that, in certain employment contexts, master's education appears to be a distinguishing factor between males and non-males. This could reflect societal or industry biases, or possibly differing educational or career choices among genders. Companies keen on diversity might want to address such disparities in their recruitment and mentorship programs, ensuring opportunities aren't skewed by gender-based educational trends.

### Test 2: Does education level significantly impact employment in the technical field?
Since we the number of known computer skills is continuous and we have more than two categories for level of education, we would like to conduct an ANOVA test to answer this question.

The assumptions we need to satisfy are:
_
_

Let's first visualize the question we are trying to answer by examining the boxplots for distribution of computer skills at all education levels.
```{r, ANOVA boxplots}
loadPkg("ggplot2")
ggplot(df_final, aes(x=EdLevel, y=ComputerSkills)) + 
  geom_boxplot( colour=c("#ff0000","#FFFF00", "#11cc11","#0000ff","#ff00ff"), alpha = .5, outlier.shape=8, outlier.size=4) +
  labs(x="Education Level", y = "Number of Computer Skills")
```

There seem to be at least some differences, and we solidify this by conducting our hypothesis test using ANOVA.

$H_0:$: There is no significant difference in the average number of computer skills acquired when comparing all individuals at every level of education.
$H_a:$ At least one education level group differs from the others in the average number of computer skills known.

```{r, ANOVA test}
anovaRes = aov(ComputerSkills ~ EdLevel, data=df_final)
anovaSummary = summary(anovaRes)
anovaSummary

# Extracting F value and p-value for the EdLevel effect
F_value = anovaSummary[[1]]["EdLevel", "F value"]
p_value = anovaSummary[[1]]["EdLevel", "Pr(>F)"]

# Extracting mean computer skills for each education level
mean_skills_NoHigherEd = mean(subset(df_final, EdLevel == "NoHigherEd")$ComputerSkills)
mean_skills_Undergraduate = mean(subset(df_final, EdLevel == "Undergraduate")$ComputerSkills)
mean_skills_Master = mean(subset(df_final, EdLevel == "Master")$ComputerSkills)
mean_skills_PhD = mean(subset(df_final, EdLevel == "PhD")$ComputerSkills)
mean_skills_Other = mean(subset(df_final, EdLevel == "Other")$ComputerSkills)

cat("The average number of computer skills for\n",
    "No Higher Ed:", mean_skills_NoHigherEd, "\n",
    "Undergraduate:", mean_skills_Undergraduate, "\n",
    "Master's:", mean_skills_Master, "\n",
    "PhD:", mean_skills_PhD, "\n",
    "Other:", mean_skills_Other, "\n",
    "Our ANOVA F test statistic is", F_value, "with p-value", p_value, ". At an alpha-level of .05, we reject the null hypothesis. We conclude that there is at least one education level for which the average number of computer skills is different from the other groups.\n")

```

The average number of computer skills for
No Higher Ed: _
Undergraduate: _
Master's: _
PhD: _
Other: _
Our ANOVA F test statistic is _ with p-value _. At an alpha-level of .05, we reject the null hypothesis. We conclude that there is at least one education level for which the average number of computer skills is different from the other groups.

Since we have a highly significant p-value based on our ANOVA test above, we want to conduct a Post Hoc analysis of the test using the standard method, Tukey's HSD test.
```{r, Post Hoc Tukey's Test}
tukeyRes <- TukeyHSD(anovaRes)
tukeyRes
```

_ The Undergraduate, Master, and PhD groups had significantly different computer skills when compared to the Other group, with all of them having lower skills (given the negative "diff" values) and p-values less than 0.05.

[real world conclusion; we could look at specific averages to determine which levels of education provide less or more computer skills i.e. quality vs quantity]

In real-world terms, this suggests that as one progresses through higher levels of education, from no higher education to a PhD, there is a substantial increase in computer skills. For employers in the technical field, this could mean that candidates with advanced degrees might bring a higher level of expertise and proficiency in computer-related tasks. However, it's also essential to consider the quality versus quantity aspect: while a higher degree might indicate more extensive knowledge, it does not necessarily guarantee the quality or applicability of that knowledge in specific job roles.

### Test 3: Is age a significant factor in determining whether an individual is a professional developer or not?

Now, since age is a continuous variable and the classification for professional development a categorical one, we would like to use a Chi square test of independence to determine whether the two variables are associated.

The assumptions we need to satisfy are:
_
_

$H_0:$ Whether an individual is a professional developer or not is independent of their age.
$H_a:$ Age and status of being a professional developer are associated with each other.
```{r, Chi square}
# We need four categories: <35, NotDev; >35, NotDev; <35 Dev; >35 Dev
notDev_under35 <- subset(df_final, df_final$Age == "<35" & df_final$MainBranch == "NotDev")
notDev_over35 <- subset(df_final, df_final$Age == ">35" & df_final$MainBranch == "NotDev")
dev_under35 <- subset(df_final, df_final$Age == "<35" & df_final$MainBranch == "Dev")
dev_over35 <- subset(df_final, df_final$Age == ">35" & df_final$MainBranch == "Dev")

# Now we conduct a chi square test of independence
chisq_matrix <- matrix(c(22686,44710,2957,3109), nrow = 2, ncol = 2)
```

The contingency table that we perform our chi square test on is the following:
```{r, Chi square table}
chisq_matrix <- matrix(c(22686,44710,2957,3109), nrow = 2, ncol = 2)

chitest = chisq.test(chisq_matrix)
chitest

cat("Our chi square test statistic is", chitest$statistic, "with p-value", chitest$p.value, ". At an alpha-level of .05 we reject the null hypothesis.")
```

Our chi square test statistic is _ with p-value _. At an alpha-level of .05 we _ the null hypothesis. We conclude that age and being a professional developer are _ associated.

We conclude that age and being a professional developer are _ associated.
Examining the results, it's clear that age significantly influences whether an individual is a professional developer or not.

This data might imply that certain age groups are more inclined or better positioned to pursue developer careers. For educational institutions, this insight can guide curriculum planning, targeting age groups that are more likely to transition into professional development.

### Does mental health influence previous salary?
To answer our final question, we conduct a two sample t test to compare the mean salary between those with and without mental health issues. (We use a t test as opposed to its normal counterpart, a z test, even though we have a large sample, size since the population variance is unknown.)

The assumptions we need to satisfy are:
_
_

$H_0:$ Whether an individual is a professional developer or not is independent of their age.
$H_a:$ Age and status of being a professional developer are associated with each other.
```{r, two sample t-test for means}
# Subset the PreviousSalary for individuals with 'Yes' and 'No' in the MentalHealth column
salary_yes <- df_final$PreviousSalary[df_final$MentalHealth == "Yes"]
salary_no <- df_final$PreviousSalary[df_final$MentalHealth == "No"]

# Checking the mean of both groups just to get an idea
format(mean(salary_yes, na.rm = TRUE), digits=5)
format(mean(salary_no, na.rm = TRUE), digits=5)

# Now we conduct a two-sample t-test on PreviousSalary between the two groups
ttest_2sample_salary_yes_no <- t.test(salary_yes, salary_no)
ttest_2sample_salary_yes_no

t_statistic = ttest_2sample_salary_yes_no$statistic
p_val = ttest_2sample_salary_yes_no$p.value

# Forming the final statement
cat("Our t-test statistic is", t_statistic, "with p-value", p_val, ".\n")
cat("At an alpha-level of .05, we reject the null hypothesis.\n")
```

Our t test statistic is _ with p-value _. At an alpha-level of .05 we _ the null hypothesis. We conclude that the mean salary of those with mental health issues is _ than those without.

This shows that those acknowledging mental health issues earned between $7,993 to $8,936 more than those who didn't. This suggests that a higher salary often carries added responsibilities, leading to stress and potential mental health challenges. Companies and HR teams can use this insight to monitor employee well-being. Job seekers should also be aware that higher salaries might come with increased mental health considerations, aiding them in making informed decisions.


## Conclusions/Key Takeaways

## Limitations

## Further Research